{
  "description": "Tatical sector strategy among U.S. equity derivatives that are liquid, with earnings that are not directly tied to commodity prices (i.e. no mining companies), and not correlated with each other",
  "portfolio": [
    "IBB.NASDAQ",
    "IHE.ARCA",
    "IHI.ARCA",
    "ITA.BATS",
    "ITB.BATS",
    "IYT.BATS",
    "SOXX.NASDAQ",
    "VNQ.ARCA",
    "XLB.ARCA",
    "XLE.ARCA",
    "XLF.ARCA",
    "XLI.ARCA",
    "XLK.ARCA",
    "XLP.ARCA",
    "XLU.ARCA",
    "XLV.ARCA",
    "XLY.ARCA"
  ],
  "columns": [
    "DATE(ending) AS date",
    "YEAR(ending) AS year",
    "MONTH(ending) AS month",
    "WEEKNUM(ending) AS week",
    "symbol",
    "exchange",
    "name",
    "IF(month.volume>1000000,0.01,month.volume>500000,0.05,month.volume>10000,0.10,0.50) AS spread",
    "ROUND(day.adj_close,2) AS close",
    "CHANGE(day.adj_close,OFFSET(1,day.adj_close)) AS change",
    "ROUND(PF(200,day.adj_close),2) AS pf",
    "ROUND(IF(SUMPREC(0,'target')<=90,MAXCORREL(60,day.adj_close,'target>0')*100,0),2) AS correl",
    "ROUND(CVAR(5,260,day.adj_close),2) AS risk",
    "ROUND(day.POVO(20)) AS povo",
    "ROUND(day.POPV(20, 85),2) AS fair",
    "ROUND(IF(SUMPREC(0,'target')<=90 AND correl<95,MIN(0.275/CVAR(5,260,day.adj_close),95-SUMPREC(0,'target'),15),0),2) AS target",
    "ROUND(position*close*100/(market+cash),2) AS weight",
    "MIN(FLOOR((PREC('market',0)+PREC('cash',balance))*ROUND((target + SUMPREV(4,'target'))/(1+COUNTPREV(4,'target')),2)/100/close)-PREV('position',0),FLOOR(0.98*available/close)) AS delta",
    "IF((PREV('position',0)=-delta OR ABS(delta)>=50 OR ABS(delta)*close>0.01*(PREC('market',0)+PREC('cash',balance))) AND (delta<0 AND day.POVO(20)>10 OR delta>0 AND day.POVO(20)<85) AND (delta<0 OR target>0),delta,0) AS shares",
    "PREV('position',0) + shares AS position",
    "close+spread*2*SIGN(shares) AS price",
    "ROUND(-price*shares,2) AS proceeds",
    "ROUND(PREV('position',0)*(price-PREV('price',0)),2) AS mtm",
    "IF(shares=0,0,ROUND(MAX(ABS(shares)*0.005,2),1.00)) AS commission",
    "IF(shares>0,ROUND((PREV('basis')*PREV('position')+price*shares)/position,2),PREV('basis',0)) AS basis",
    "ROUND(PREC('market',0) + position * price - PREV('position',0) * PREV('price',0),2) AS market",
    "PREC('cash', balance) + proceeds - commission AS cash",
    "MAX(PREC('cash', balance) - SUMPREC(2,'proceeds','>0'),0) AS available",
    "IF(PREC('peek',0)<market+cash,market+cash,PREC('peek',0)) AS peek",
    "IF(PREC('drawdown',0)<peek-market-cash,peek-market-cash,PREC('drawdown',0)) AS drawdown"
  ],
  "retain": "DAYS(month.ending, OFFSET(12,month.ending)) >= 300",
  "precedence": "DESC(PF(200,day.adj_close))",
  "pad_leading": 20,
  "duration": "P1Y"
}
